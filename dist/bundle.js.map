{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../phocus/dist/index.js","webpack:///../phocus/dist/action-context/action-context.js","webpack:///../phocus/dist/hotkey/hotkey.js","webpack:///../phocus/dist/dom-manipulation/add-trigger.js","webpack:///./index.js","webpack:///../phocus/dist/constrain-focus/constrain-focus.js","webpack:///../phocus/dist/dom-manipulation/start-phocus.js","webpack:///../phocus/dist/dom-manipulation/dispatch.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","action_context_1","Action","ActionContextService","hotkey_1","Hotkey","constrain_focus_1","ConstrainFocusService","start_phocus_1","startPhocus","ActionInContext","action","contextName","argument","element","service","this","configurable","act","e","actOn","context","contexts","description","remappedKey","shortDocumentation","searchTerms","defaultKeys","hidden","label","keys","ActionContextServiceClass","remappingDirty","contextStack","addContext","console","warn","clear","getContextStack","elt","stack","parentElement","dataset","phocusContextName","unshift","phocusContextArgument","setContext","remapAction","newMapping","unremapAction","unmapAction","_this","ll","map","actions","actionName","mapping","concat","apply","filter","x","restoreRemapping","remapping","actionsInContexts","accum","length","contextEntry","contextFor","error","actionsFromContext","opaque","actionsByName","actionForKeypress","availableActions","find","actionInContext","indexOf","handleKeypress","event","canonicalKeyFromEvent","keyAction","preventDefault","stopPropagation","actionForName","triggerAction","3","6","8","9","12","13","16","17","18","19","20","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","48","49","50","51","52","53","54","55","56","57","91","93","144","145","181","182","183","186","187","188","189","190","191","192","219","220","221","222","224","225","246","247","248","249","250","251","letter","String","fromCharCode","toLowerCase","toUpperCase","HotkeyClass","displayMap","Alt","Meta","OS","Shift","Control","modifiers","isMacLike","navigator","platform","match","keyName"," ","modifierKeyNameForPlatform","displayKey","canonicalKey","parts","split","pop","join","keyCode","getModifierState","onClick","target","HTMLElement","phocusAction","triggerableTags","addTrigger","tagName","info","setAttribute","oldContext","title","innerText","addEventListener","removeTrigger","removeEventListener","__webpack_exports__","phocus__WEBPACK_IMPORTED_MODULE_0__","maxId","add","_","newId","querySelector","innerHTML","lastChild","focus","start","id","log","classList","finish","remove","delete","next","nextElementSibling","previous","previousElementSibling","window","document","body","ConstrainFocus","handler","noConstraints","root","currentRoot","relatedTarget","contains","stop","focusable","pushConstraint","popConstraint","shift","observer","dispatch_1","add_trigger_1","keydown","focusedElement","focused","activeElement","setFocusedContext","observe","mutations","forEach","addedNodes","dispatch","type","MutationObserver","childList","subtree","attributes","attributeFilter","debug","stopPhocus","undispatch","disconnect","children","querySelectorAll","Array","from"],"mappings":"aACA,IAAAA,KAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,IACAG,EAAAH,EACAI,GAAA,EACAH,YAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,IAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,GAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,eAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,aAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,cAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,KAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,GAIAlC,IAAAmC,EAAA,kCCjFArB,OAAAC,eAAAb,EAAA,cAA8CmB,OAAA,IAC9C,IAAAe,EAAuBpC,EAAQ,GAC/BE,EAAAmC,OAAAD,EAAAC,OACAnC,EAAAoC,qBAAAF,EAAAE,qBACA,IAAAC,EAAevC,EAAQ,GACvBE,EAAAsC,OAAAD,EAAAC,OACA,IAAAC,EAAwBzC,EAAQ,GAChCE,EAAAwC,sBAAAD,EAAAC,sBACA,IAAAC,EAAqB3C,EAAQ,GAC7BE,EAAA0C,YAAAD,EAAAC,0CCTA9B,OAAAC,eAAAb,EAAA,cAA8CmB,OAAA,IAC9C,IAAAkB,EAAevC,EAAQ,GAIvB6C,EAAA,WACA,SAAAA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GACAC,KAAAL,SACAK,KAAAJ,cACAI,KAAAH,WACAG,KAAAF,UACAE,KAAAD,UAeA,OAbApC,OAAAC,eAAA8B,EAAAb,UAAA,eACAf,IAAA,WACA,QAAAkC,KAAAH,UAEAhC,YAAA,EACAoC,cAAA,IAEAP,EAAAb,UAAAqB,IAAA,SAAAC,GACA,OAAAH,KAAAL,OAAAS,MAAAJ,KAAAH,SAAAG,KAAAF,QAAAK,IAEAT,EAAAb,UAAAwB,QAAA,WACAL,KAAAD,QAAAO,SAAAN,KAAAJ,cAEAF,EArBA,GAuBA3C,EAAA2C,kBAGA,IAAAR,EAAA,WACA,SAAAA,EAAAqB,GACAP,KAAAQ,YAAA,KACAR,KAAAQ,YAAA,KACAR,KAAAxC,KAAA+C,EAAA/C,KACAwC,KAAAS,mBAAAF,EAAAE,mBACAT,KAAAU,YAAAH,EAAAG,YACAV,KAAAI,MAAAG,EAAAH,MACAJ,KAAAW,YAAAJ,EAAAI,YACAX,KAAAY,OAAAL,EAAAK,SAAA,EAoBA,OAlBAjD,OAAAC,eAAAsB,EAAAL,UAAA,QACAf,IAAA,WACA,OAAAkC,KAAAQ,aACAR,KAAAQ,aACAR,KAAAW,aAEA9C,YAAA,EACAoC,cAAA,IAEAf,EAAAL,UAAAgC,MAAA,WACA,IAAArC,EAAAwB,KAAAc,KAAA,GACA,OAAAtC,EACAwB,KAAAxC,KAAA,KAAAgB,EAAA,IAGAwB,KAAAxC,MAGA0B,EA7BA,GA+BAnC,EAAAmC,SACA,IAAA6B,EAAA,WACA,SAAAA,IACAf,KAAAM,YACAN,KAAAgB,gBAAA,EACAhB,KAAAiB,gBAmJA,OAjJAF,EAAAlC,UAAAqC,WAAA,SAAA1D,EAAA6C,GACAL,KAAAM,SAAA9C,IACA2D,QAAAC,KAAA,yCAAA5D,GAEAwC,KAAAM,SAAA9C,GAAA6C,GAEAU,EAAAlC,UAAAwC,MAAA,WACArB,KAAAiB,iBAEAF,EAAAlC,UAAAyC,gBAAA,SAAAC,GACA,IAAAA,EACA,SACA,IAAAC,EAAAxB,KAAAsB,gBAAAC,EAAAE,eAQA,OAPAF,EAAAG,QAAAC,mBACAH,EAAAI,SACAvB,QAAAkB,EAAAG,QAAAC,kBACA9B,SAAA0B,EAAAG,QAAAG,sBACA/B,QAAAyB,IAGAC,GAEAT,EAAAlC,UAAAiD,WAAA,SAAAP,GACAvB,KAAAiB,aAAAjB,KAAAsB,gBAAAC,IAGAR,EAAAlC,UAAAkD,YAAA,SAAApC,EAAAqC,GACArC,EAAAa,YAAAwB,GAGAjB,EAAAlC,UAAAoD,cAAA,SAAAtC,GACAA,EAAAa,YAAA,MAGAO,EAAAlC,UAAAqD,YAAA,SAAAvC,GACAA,EAAAa,YAAA,QAEA7C,OAAAC,eAAAmD,EAAAlC,UAAA,oBAEAf,IAAA,WACA,IAAAqE,EAAAnC,KACAoC,EAAAzE,OAAAmD,KAAAd,KAAAM,UAAA+B,IAAA,SAAAzC,GACA,IAAAS,EAAA8B,EAAA7B,SAAAV,GACA,GAAAS,EAEA,OAAA1C,OAAAmD,KAAAT,EAAAiC,SAAAD,IAAA,SAAAE,GACA,IAAA5C,EAAAU,EAAAiC,QAAAC,GACA,GAAA5C,EAAAa,YAEA,OACAb,OAAA4C,EACAlC,QAAAT,EACA4C,QAAA7C,EAAAa,iBAIA,SAAAiC,OAAAC,SAAAN,GAAAO,OAAA,SAAAC,GAAgE,OAAAA,KAEhE/E,YAAA,EACAoC,cAAA,IAEAc,EAAAlC,UAAAgE,iBAAA,SAAAC,GACA,IAAAX,EAAAnC,KACA8C,GAEAA,EAAAT,IAAA,SAAAhF,GACA,IACAsC,EADAwC,EAAA7B,SAAAjD,EAAAgD,SACAiC,QAAAjF,EAAAsC,QACAwC,EAAAJ,YAAApC,EAAAtC,EAAAmF,YAGA7E,OAAAC,eAAAmD,EAAAlC,UAAA,oBAGAf,IAAA,WACA,OAAAkC,KAAA+C,kBAAA/C,KAAAiB,eAEApD,YAAA,EACAoC,cAAA,IAEAc,EAAAlC,UAAAkE,kBAAA,SAAA9B,GAEA,IADA,IAAA+B,KACA/F,EAAA,EAAuBA,EAAAgE,EAAAgC,OAAyBhG,IAAA,CAChD,IAAAiG,EAAAjC,EAAAhE,GACAoD,EAAAL,KAAAmD,WAAAD,GACA,IAAA7C,EAEA,YADAc,QAAAiC,MAAA,0BAAAF,EAAA7C,SAGA,IAAAiC,EAAAtC,KAAAqD,mBAAAH,GAEA,GADAF,IAAAP,OAAAH,GACAjC,EAAAiD,OACA,MAGA,OAAAN,GAEAjC,EAAAlC,UAAAwE,mBAAA,SAAAH,GACA,IAAAf,EAAAnC,KAEAuD,EADAvD,KAAAmD,WAAAD,GACAZ,QACA,OAAA3E,OAAAmD,KAAAyC,GAAAlB,IAAA,SAAA7E,GACA,WAAAkC,EAAA6D,EAAA/F,GAAA0F,EAAA7C,QAAA6C,EAAArD,SAAAqD,EAAApD,QAAAqC,MAGApB,EAAAlC,UAAAsE,WAAA,SAAAD,GACA,OAAAlD,KAAAM,SAAA4C,EAAA7C,UAEAU,EAAAlC,UAAA2E,kBAAA,SAAAhF,GACA,IAAAiF,EAAAzD,KAAAyD,iBACA,GAAAA,EAEA,OAAAA,EAAAC,KAAA,SAAAC,GAEA,OADAA,EAAAhE,OACAmB,KAAA8C,QAAApF,IAAA,KAGAuC,EAAAlC,UAAAgF,eAAA,SAAAC,GACA,IAAAtF,EAAAY,EAAAC,OAAA0E,sBAAAD,GACAE,EAAAhE,KAAAwD,kBAAAhF,GACAwF,IACAF,EAAAG,iBACAH,EAAAI,kBACAF,EAAA9D,IAAA4D,KAGA/C,EAAAlC,UAAAsF,cAAA,SAAA3G,GACA,IAAA2E,EAAAnC,KACAkD,EAAAlD,KAAAiB,aAAAyC,KAAA,SAAApG,GACA,IAAA+C,EAAA8B,EAAAgB,WAAA7F,GACA,OAAA+C,GAAA7C,KAAA6C,EAAAiC,UAEA,GAAAY,EAAA,CAEA,IAAA7C,EAAAL,KAAAmD,WAAAD,GACA,WAAAxD,EAAAW,EAAAiC,QAAA9E,GAAA0F,EAAA7C,QAAA6C,EAAArD,SAAAqD,EAAApD,QAAAE,QAEAe,EAAAlC,UAAAuF,cAAA,SAAA5G,EAAA2C,GACA,IAAAR,EAAAK,KAAAmE,cAAA3G,GACAmC,EAIAA,EAAAO,IAAAC,GAHAgB,QAAAiC,MAAA,4BAAA5F,EAAA,IAAAwC,KAAAiB,eAKAF,EAvJA,GAyJAhE,EAAAgE,4BACAhE,EAAAoC,qBAAA,IAAA4B,gCCzNApD,OAAAC,eAAAb,EAAA,cAA8CmB,OAAA,IAuE9C,IAtEA,IAAA4C,GACAuD,GAAA,mBACAC,GAAA,eACAC,GAAA,yBACAC,GAAA,aACAC,IAAA,iBACAC,IAAA,iBACAC,IAAA,iBACAC,IAAA,qBACAC,IAAA,aACAC,IAAA,iBACAC,IAAA,uBACAC,IAAA,mBACAC,IAAA,qBACAC,IAAA,2BACAC,IAAA,mBACAC,IAAA,2BACAC,IAAA,SACAC,IAAA,mBACAC,IAAA,uBACAC,IAAA,aACAC,IAAA,eACAC,IAAA,yBACAC,IAAA,qBACAC,IAAA,2BACAC,IAAA,yBACAC,IAAA,mBACAC,IAAA,iBACAC,IAAA,qBACAC,IAAA,6BACAC,IAAA,mBACAC,IAAA,mBACAC,IAAA,SACAC,IAAA,SACAC,IAAA,SACAC,IAAA,SACAC,IAAA,SACAC,IAAA,SACAC,IAAA,SACAC,IAAA,SACAC,IAAA,SACAC,IAAA,SACAC,IAAA,WACAC,IAAA,6BACAC,KAAA,qBACAC,KAAA,2BACAC,KAAA,2BACAC,KAAA,2BACAC,KAAA,uBACAC,KAAA,IAAY,KACZC,KAAA,SACAC,KAAA,SACAC,KAAA,SACAC,KAAA,SACAC,KAAA,SACAC,KAAA,SACAC,KAAA,SACAC,KAAA,UACAC,KAAA,SACAC,KAAA,SACAC,KAAA,eACAC,KAAA,uBACAC,KAAA,eACAC,KAAA,iBACAC,KAAA,iBACAC,KAAA,uBACAC,KAAA,eACAC,KAAA,sBAEAC,EAAA,GACAvL,EAAA,GAAgBA,EAAA,GAAQA,IACxBuL,EAAAC,OAAAC,aAAAzL,GACA6D,EAAA7D,IAAAuL,EAAAG,cAAAH,EAAAI,eAEA,IAAAC,EAAA,WACA,SAAAA,IAEA7I,KAAA8I,YACAC,IAAA,OACAC,KAAA,KACAC,GAAA,KACAC,MAAA,IACAC,QAAA,SAEAnJ,KAAAoJ,WAAA,qCACApJ,KAAAqJ,YAAAC,UAAAC,SAAAC,MAAA,2BA8BA,OA5BAX,EAAAhK,UAAA4K,QAAA,SAAAjL,GAIA,OAFAkL,IAAA,SACSlL,IACTA,GAEAqK,EAAAhK,UAAA8K,2BAAA,SAAAnL,GACA,OAAAwB,KAAA8I,WAAAtK,IAEAqK,EAAAhK,UAAA+K,WAAA,SAAAC,GACA,IAAA1H,EAAAnC,KACA8J,EAAAD,EAAAE,MAAA,KACAvL,EAAAsL,EAAAE,MAIA,OAHAF,EAAAzH,IAAA,SAAA7D,GACA,OAAA2D,EAAAwH,2BAAAnL,KAEAyL,KAAA,IAAAzL,GAEAqK,EAAAhK,UAAAkF,sBAAA,SAAA5D,GACA,IAAA3B,EAAAsC,EAAAX,EAAA+J,SAAA/J,EAAAgK,iBAAA,cACA,OAAAnK,KAAAoJ,UAAAxF,QAAApF,IAAA,EACA,GAEAwB,KAAAoJ,UAAA/G,IAAA,SAAA7D,GACA,OAAA2B,EAAAgK,iBAAA3L,KAAA,SAEAyL,KAAA,IAAAjK,KAAAyJ,QAAAjL,IAEAqK,EAzCA,GA2CA9L,EAAA8L,cACA9L,EAAAsC,OAAA,IAAAwJ,gCCvHAlL,OAAAC,eAAAb,EAAA,cAA8CmB,OAAA,IAC9C,IAAAe,EAAuBpC,EAAQ,GAC/B,SAAAuN,EAAAjK,GACAA,EAAAkK,kBAAAC,aAEAnK,EAAAkK,OAAA3I,QAAA6I,eAEAtL,EAAAE,qBAAA2C,WAAA3B,EAAAkK,QACApL,EAAAE,qBAAAiF,cAAAjE,EAAAkK,OAAA3I,QAAA6I,eAEAxN,EAAAyN,iBAAA,cAiCAzN,EAAA0N,WAhCA,SAAAlJ,GACA,GAAAA,EAAAG,QAAA6I,aAAA,CAEA,IAAA5K,EAAA4B,EAAAG,QAAA6I,aACAxN,EAAAyN,gBAAA5G,QAAArC,EAAAmJ,QAAA/B,eAAA,IACAxH,QAAAiC,MAAA7B,EAAAmJ,QAAA,yBAAA/K,EAAA,yDACAwB,QAAAwJ,KAAA,2CACApJ,EAAAqJ,aAAA,kBAEA,IAAAC,EAAA5L,EAAAE,qBAAA8B,aACA,IAEAhC,EAAAE,qBAAA2C,WAAAP,GACA,IAAAoC,EAAA1E,EAAAE,qBAAAgF,cAAAxE,GACA,IAAAgE,EAEA,YADAxC,QAAAiC,MAAA,4BAAAzD,EAAAV,EAAAE,qBAAA8B,cAGAM,EAAAuJ,MAAAnH,EAAAhE,OAAAkB,QACAU,EAAAqJ,aAAA,aAAAjH,EAAAhE,OAAAkB,SAEA,IAAAU,EAAAwJ,YACAxJ,EAAAwJ,UAAApH,EAAAhE,OAAAnC,MAGA+D,EAAAyJ,iBAAA,QAAAZ,GAEA,QAEAnL,EAAAE,qBAAA8B,aAAA4J,KAOA9N,EAAAkO,cAHA,SAAA1J,GACAA,EAAA2J,oBAAA,QAAAd,kCC9CAvN,EAAAkB,EAAAoN,GAAA,IAAAC,EAAAvO,EAAA,GAEAwO,EAAA,EAEAD,EAAA,qBAAoBlK,WAAA,aACpBoB,SACAgJ,IAAA,IAAaF,EAAA,QACb5N,KAAA,gBACAmD,aAAA,aACAP,MAAA,CAAAmL,EAAAhK,KAEA,MAAAiK,IAAAH,EAGA9J,EAAAkK,cAAA,MAAAC,yHAEoBF,8QAOpBjK,EAAAkK,cAAA,MAAAE,UAAAC,cAMAR,EAAA,qBAAoBlK,WAAA,aACpBoB,SACAuJ,MAAA,IAAeT,EAAA,QACf5N,KAAA,QACAmD,aAAA,KACAP,MAAA,CAAA0L,EAAAvK,KAEAJ,QAAA4K,kBAAkCD,KAElCvK,EAAAyK,UAAAV,IAAA,cAGAW,OAAA,IAAgBb,EAAA,QAChB5N,KAAA,SACAmD,aAAA,KACAP,MAAA,CAAA0L,EAAAvK,KAEAJ,QAAA4K,mBAAmCD,KAEnCvK,EAAAyK,UAAAE,OAAA,WACA3K,EAAAyK,UAAAV,IAAA,eAGAa,OAAA,IAAgBf,EAAA,QAChB5N,KAAA,SACAmD,aAAA,aACAP,MAAA,CAAA0L,EAAAvK,KAEAJ,QAAA4K,mBAAmCD,KAEnCvK,EAAA2K,YAGAE,KAAA,IAAchB,EAAA,QACd5N,KAAA,OACAmD,aAAA,iBACAP,MAAA,CAAA0L,EAAAvK,KACAA,EAAA8K,oBAAA9K,EAAA8K,mBAAAT,WAGAU,SAAA,IAAkBlB,EAAA,QAClB5N,KAAA,WACAmD,aAAA,eACAP,MAAA,CAAA0L,EAAAvK,KACAA,EAAAgL,wBAAAhL,EAAAgL,uBAAAX,cAMAY,OAAAxB,iBAAA,YACErN,OAAAyN,EAAA,YAAAzN,CAAW8O,SAAAC,MACbD,SAAAhB,cAAA,MAAAG,wCC5EAjO,OAAAC,eAAAb,EAAA,cAA8CmB,OAAA,IAC9C,IAAAyO,EAAA,WACA,SAAAA,IACA,IAAAxK,EAAAnC,KACAA,KAAAwB,SACAxB,KAAA4M,QAAA,SAAAzM,GACA,IAAAgC,EAAA0K,gBAAA,CAEA,IAAAC,EAAA3K,EAAA4K,cACAD,GAEA3M,EAAA6M,gBAEAF,EAAAG,SAAA9M,EAAA6M,iBACAF,EAAAG,SAAA9M,EAAAkK,QACAlK,EAAAkK,OAAAuB,QAGAkB,EAAArB,cAAA,kBAAAG,YA2BA,OAtBAe,EAAA9N,UAAAgN,MAAA,WACAY,SAAAzB,iBAAA,OAAAhL,KAAA4M,SAAA,IAEAD,EAAA9N,UAAAqO,KAAA,WACAT,SAAAvB,oBAAA,OAAAlL,KAAA4M,SAAA,IAEAD,EAAA9N,UAAAsO,UAAA,SAAArN,GACA,IAAAgN,EAAA9M,KAAA+M,cACA,OAAA/M,KAAA6M,iBAAAC,KAAAG,SAAAnN,IAEA6M,EAAA9N,UAAAkO,YAAA,WACA,OAAA/M,KAAAwB,MAAA,IAAAxB,KAAAwB,MAAA,MAEAmL,EAAA9N,UAAAuO,eAAA,SAAAN,GACA9M,KAAAwB,MAAAI,QAAAkL,IAEAH,EAAA9N,UAAAwO,cAAA,WACArN,KAAAwB,MAAA8L,SAEAX,EAAA9N,UAAAgO,cAAA,WACA,UAAA7M,KAAAwB,MAAAyB,QAEA0J,EA5CA,GA8CA5P,EAAA4P,iBACA5P,EAAAwC,sBAAA,IAAAoN,gCCpDAhP,OAAAC,eAAAb,EAAA,cAA8CmB,OAAA,IAC9C,IAwCAqP,EAxCAtO,EAAuBpC,EAAQ,GAC/B2Q,EAAiB3Q,EAAQ,GACzB4Q,EAAoB5Q,EAAQ,GAC5ByC,EAAwBzC,EAAQ,GAgBhC,SAAA6Q,EAAAvN,IAfA,WACA,IACAwN,EADAC,EAAAnB,SAAAoB,eAMAF,EAJAC,aAAAtD,cAAAsD,EAAAnM,cAIAmM,EAHAA,EAAAnM,gBAOAkM,GAAAlB,SAAAC,MAEAzN,EAAAE,qBAAA2C,WAAA6L,GAGAG,GACA7O,EAAAE,qBAAA0E,eAAA1D,GAEA,SAAA4N,EAAAC,GACAA,EAAAC,QAAA,SAAA5Q,GACAA,EAAA6Q,WAAAD,QAAA,SAAAvP,GACAA,aAAA4L,aAEAkD,EAAAW,SAAAzP,KAEA,cAAArB,EAAA+Q,MAAA/Q,EAAAgN,kBAAAC,cACAjN,EAAAgN,OAAA3I,QAAA6I,aACAkD,EAAAhD,WAAApN,EAAAgN,QAGAoD,EAAAxC,cAAA5N,EAAAgN,WAmBAtN,EAAA0C,YAbA,SAAA8B,GACAiM,EAAAW,SAAA5M,GACAkL,SAAAzB,iBAAA,UAAA0C,IACAH,EAAA,IAAAc,iBAAAN,IACAA,QAAAxM,GACA+M,WAAA,EACAC,SAAA,EACAC,YAAA,EACAC,iBAAA,wBAEAnP,EAAAC,sBAAAsM,QACA1K,QAAAuN,MAAA,kCAUA3R,EAAA4R,WAPA,SAAApN,GACAiM,EAAAoB,WAAArN,GACAkL,SAAAvB,oBAAA,UAAAwC,GACAH,EAAAsB,aACAvP,EAAAC,sBAAA2N,OACA/L,QAAAuN,MAAA,4DC7DA/Q,OAAAC,eAAAb,EAAA,cAA8CmB,OAAA,IAC9C,IAAAuP,EAAoB5Q,EAAQ,GAY5BE,EAAAoR,SAXA,SAAA5M,GACAA,EAAAG,QAAA6I,cACAkD,EAAAhD,WAAAlJ,GAEA,IAAAuN,EAAAvN,EAAAwN,iBAAA,oDACAC,MAAAC,KAAAH,GAAAb,QAAA,SAAA9N,GACAA,aAAAmK,aAEAmD,EAAAhD,WAAAtK,MAeApD,EAAA6R,WAXA,SAAArN,GACAA,EAAAG,QAAA6I,cACAkD,EAAAxC,cAAA1J,GAEA,IAAAuN,EAAAvN,EAAAwN,iBAAA,oDACAC,MAAAC,KAAAH,GAAAb,QAAA,SAAA9N,GACAA,aAAAmK,aAEAmD,EAAAxC,cAAA9K","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar action_context_1 = require(\"./action-context/action-context\");\nexports.Action = action_context_1.Action;\nexports.ActionContextService = action_context_1.ActionContextService;\nvar hotkey_1 = require(\"./hotkey/hotkey\");\nexports.Hotkey = hotkey_1.Hotkey;\nvar constrain_focus_1 = require(\"./constrain-focus/constrain-focus\");\nexports.ConstrainFocusService = constrain_focus_1.ConstrainFocusService;\nvar start_phocus_1 = require(\"./dom-manipulation/start-phocus\");\nexports.startPhocus = start_phocus_1.startPhocus;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar hotkey_1 = require(\"../hotkey/hotkey\");\n// Actions have one free argument; when a context is pushed onto the stack, that\n// argument is stored along with it. An ActionInContext closes over the argument\n// so that the action can be called anywhere\nvar ActionInContext = /** @class */ (function () {\n    function ActionInContext(action, contextName, argument, element, service) {\n        this.action = action;\n        this.contextName = contextName;\n        this.argument = argument;\n        this.element = element;\n        this.service = service;\n    }\n    Object.defineProperty(ActionInContext.prototype, \"hasArgument\", {\n        get: function () {\n            return !!this.argument;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ActionInContext.prototype.act = function (e) {\n        return this.action.actOn(this.argument, this.element, e);\n    };\n    ActionInContext.prototype.context = function () {\n        this.service.contexts[this.contextName];\n    };\n    return ActionInContext;\n}());\nexports.ActionInContext = ActionInContext;\n// An action is anything you can do in a given context. It can be mapped to a\n// keyboard shortcut.\nvar Action = /** @class */ (function () {\n    function Action(description) {\n        this.remappedKey = null;\n        this.remappedKey = null;\n        this.name = description.name;\n        this.shortDocumentation = description.shortDocumentation;\n        this.searchTerms = description.searchTerms;\n        this.actOn = description.actOn;\n        this.defaultKeys = description.defaultKeys;\n        this.hidden = description.hidden || false;\n    }\n    Object.defineProperty(Action.prototype, \"keys\", {\n        get: function () {\n            if (this.remappedKey)\n                return [this.remappedKey];\n            return this.defaultKeys;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Action.prototype.label = function () {\n        var key = this.keys[0];\n        if (key) {\n            return this.name + \" (\" + key + \")\";\n        }\n        else {\n            return this.name;\n        }\n    };\n    return Action;\n}());\nexports.Action = Action;\nvar ActionContextServiceClass = /** @class */ (function () {\n    function ActionContextServiceClass() {\n        this.contexts = {};\n        this.remappingDirty = false;\n        this.contextStack = [];\n    }\n    ActionContextServiceClass.prototype.addContext = function (name, context) {\n        if (this.contexts[name]) {\n            console.warn(\"Replacing existing context blueprint: \", name);\n        }\n        this.contexts[name] = context;\n    };\n    ActionContextServiceClass.prototype.clear = function () {\n        this.contextStack = [];\n    };\n    ActionContextServiceClass.prototype.getContextStack = function (elt) {\n        if (!elt)\n            return [];\n        var stack = this.getContextStack(elt.parentElement);\n        if (elt.dataset.phocusContextName) {\n            stack.unshift({\n                context: elt.dataset.phocusContextName,\n                argument: elt.dataset.phocusContextArgument,\n                element: elt\n            });\n        }\n        return stack;\n    };\n    ActionContextServiceClass.prototype.setContext = function (elt) {\n        this.contextStack = this.getContextStack(elt);\n    };\n    /** Give a user-specific key command for an action. */\n    ActionContextServiceClass.prototype.remapAction = function (action, newMapping) {\n        action.remappedKey = newMapping;\n    };\n    /** Remove a user-specific key command for an action. */\n    ActionContextServiceClass.prototype.unremapAction = function (action) {\n        action.remappedKey = null;\n    };\n    /** Remove a user-specific key command for an action. */\n    ActionContextServiceClass.prototype.unmapAction = function (action) {\n        action.remappedKey = \"None\";\n    };\n    Object.defineProperty(ActionContextServiceClass.prototype, \"currentRemapping\", {\n        /** Collect all user-remapped actions so that they can be saved */\n        get: function () {\n            var _this = this;\n            var ll = Object.keys(this.contexts).map(function (contextName) {\n                var context = _this.contexts[contextName];\n                if (!context)\n                    return; // TODO assertion, probs\n                return Object.keys(context.actions).map(function (actionName) {\n                    var action = context.actions[actionName];\n                    if (!action.remappedKey)\n                        return;\n                    return {\n                        action: actionName,\n                        context: contextName,\n                        mapping: action.remappedKey\n                    };\n                });\n            });\n            return [].concat.apply([], ll).filter(function (x) { return x; });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ActionContextServiceClass.prototype.restoreRemapping = function (remapping) {\n        var _this = this;\n        if (!remapping)\n            return;\n        remapping.map(function (m) {\n            var context = _this.contexts[m.context];\n            var action = context.actions[m.action];\n            _this.remapAction(action, m.mapping);\n        });\n    };\n    Object.defineProperty(ActionContextServiceClass.prototype, \"availableActions\", {\n        /** Collect actions, along with the appropriate argument, from all\n         * contexts in the active stack, smallest context first */\n        get: function () {\n            return this.actionsInContexts(this.contextStack);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ActionContextServiceClass.prototype.actionsInContexts = function (contextStack) {\n        var accum = [];\n        for (var i = 0; i < contextStack.length; i++) {\n            var contextEntry = contextStack[i];\n            var context = this.contextFor(contextEntry);\n            if (!context) {\n                console.error(\"Unknown action context:\", contextEntry.context);\n                return;\n            }\n            var actions = this.actionsFromContext(contextEntry);\n            accum = accum.concat(actions);\n            if (context.opaque) {\n                break;\n            }\n        }\n        return accum;\n    };\n    ActionContextServiceClass.prototype.actionsFromContext = function (contextEntry) {\n        var _this = this;\n        var context = this.contextFor(contextEntry);\n        var actionsByName = context.actions;\n        return Object.keys(actionsByName).map(function (name) {\n            return new ActionInContext(actionsByName[name], contextEntry.context, contextEntry.argument, contextEntry.element, _this);\n        });\n    };\n    ActionContextServiceClass.prototype.contextFor = function (contextEntry) {\n        return this.contexts[contextEntry.context];\n    };\n    ActionContextServiceClass.prototype.actionForKeypress = function (key) {\n        var availableActions = this.availableActions;\n        if (!availableActions)\n            return;\n        return availableActions.find(function (actionInContext) {\n            var action = actionInContext.action;\n            return action.keys.indexOf(key) >= 0;\n        });\n    };\n    ActionContextServiceClass.prototype.handleKeypress = function (event) {\n        var key = hotkey_1.Hotkey.canonicalKeyFromEvent(event);\n        var keyAction = this.actionForKeypress(key);\n        if (keyAction) {\n            event.preventDefault();\n            event.stopPropagation();\n            keyAction.act(event);\n        }\n    };\n    ActionContextServiceClass.prototype.actionForName = function (name) {\n        var _this = this;\n        var contextEntry = this.contextStack.find(function (c) {\n            var context = _this.contextFor(c);\n            return context && name in context.actions;\n        });\n        if (!contextEntry)\n            return;\n        var context = this.contextFor(contextEntry);\n        return new ActionInContext(context.actions[name], contextEntry.context, contextEntry.argument, contextEntry.element, this);\n    };\n    ActionContextServiceClass.prototype.triggerAction = function (name, e) {\n        var action = this.actionForName(name);\n        if (!action) {\n            console.error(\"No action found for name \" + name + \".\", this.contextStack);\n            return;\n        }\n        action.act(e);\n    };\n    return ActionContextServiceClass;\n}());\nexports.ActionContextServiceClass = ActionContextServiceClass;\nexports.ActionContextService = new ActionContextServiceClass();\n//# sourceMappingURL=action-context.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar keys = {\n    3: [\"Cancel\", \"Cancel\"],\n    6: [\"Help\", \"Help\"],\n    8: [\"Backspace\", \"Backspace\"],\n    9: [\"Tab\", \"Tab\"],\n    12: [\"Clear\", \"Clear\"],\n    13: [\"Enter\", \"Enter\"],\n    16: [\"Shift\", \"Shift\"],\n    17: [\"Control\", \"Control\"],\n    18: [\"Alt\", \"Alt\"],\n    19: [\"Pause\", \"Pause\"],\n    20: [\"CapsLock\", \"CapsLock\"],\n    27: [\"Escape\", \"Escape\"],\n    28: [\"Convert\", \"Convert\"],\n    29: [\"NonConvert\", \"NonConvert\"],\n    30: [\"Accept\", \"Accept\"],\n    31: [\"ModeChange\", \"ModeChange\"],\n    32: [\" \", \" \"],\n    33: [\"PageUp\", \"PageUp\"],\n    34: [\"PageDown\", \"PageDown\"],\n    35: [\"End\", \"End\"],\n    36: [\"Home\", \"Home\"],\n    37: [\"ArrowLeft\", \"ArrowLeft\"],\n    38: [\"ArrowUp\", \"ArrowUp\"],\n    39: [\"ArrowRight\", \"ArrowRight\"],\n    40: [\"ArrowDown\", \"ArrowDown\"],\n    41: [\"Select\", \"Select\"],\n    42: [\"Print\", \"Print\"],\n    43: [\"Execute\", \"Execute\"],\n    44: [\"PrintScreen\", \"PrintScreen\"],\n    45: [\"Insert\", \"Insert\"],\n    46: [\"Delete\", \"Delete\"],\n    48: [\"0\", \")\"],\n    49: [\"1\", \"!\"],\n    50: [\"2\", \"@\"],\n    51: [\"3\", \"#\"],\n    52: [\"4\", \"$\"],\n    53: [\"5\", \"%\"],\n    54: [\"6\", \"^\"],\n    55: [\"7\", \"&\"],\n    56: [\"8\", \"*\"],\n    57: [\"9\", \"(\"],\n    91: [\"OS\", \"OS\"],\n    93: [\"ContextMenu\", \"ContextMenu\"],\n    144: [\"NumLock\", \"NumLock\"],\n    145: [\"ScrollLock\", \"ScrollLock\"],\n    181: [\"VolumeMute\", \"VolumeMute\"],\n    182: [\"VolumeDown\", \"VolumeDown\"],\n    183: [\"VolumeUp\", \"VolumeUp\"],\n    186: [\";\", \":\"],\n    187: [\"=\", \"+\"],\n    188: [\",\", \"<\"],\n    189: [\"-\", \"_\"],\n    190: [\".\", \">\"],\n    191: [\"/\", \"?\"],\n    192: [\"`\", \"~\"],\n    219: [\"[\", \"{\"],\n    220: [\"\\\\\", \"|\"],\n    221: [\"]\", \"}\"],\n    222: [\"'\", '\"'],\n    224: [\"Meta\", \"Meta\"],\n    225: [\"AltGraph\", \"AltGraph\"],\n    246: [\"Attn\", \"Attn\"],\n    247: [\"CrSel\", \"CrSel\"],\n    248: [\"ExSel\", \"ExSel\"],\n    249: [\"EraseEof\", \"EraseEof\"],\n    250: [\"Play\", \"Play\"],\n    251: [\"ZoomOut\", \"ZoomOut\"]\n};\nvar letter = \"\";\nfor (var i = 65; i < 91; i++) {\n    letter = String.fromCharCode(i);\n    keys[i] = [letter.toLowerCase(), letter.toUpperCase()];\n}\nvar HotkeyClass = /** @class */ (function () {\n    function HotkeyClass() {\n        // TODO change map for mac/PC\n        this.displayMap = {\n            Alt: \"Alt+\",\n            Meta: \"\\u2318+\",\n            OS: \"\\u229E+\",\n            Shift: \"\\u21E7\",\n            Control: \"Ctrl+\"\n        };\n        this.modifiers = [\"Control\", \"Alt\", \"Shift\", \"Meta\", \"OS\"];\n        this.isMacLike = !!navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i);\n    }\n    HotkeyClass.prototype.keyName = function (key) {\n        var keyString = {\n            \" \": \"Space\"\n        }[key];\n        return keyString || key;\n    };\n    HotkeyClass.prototype.modifierKeyNameForPlatform = function (key) {\n        return this.displayMap[key];\n    };\n    HotkeyClass.prototype.displayKey = function (canonicalKey) {\n        var _this = this;\n        var parts = canonicalKey.split(\"+\");\n        var key = parts.pop();\n        var modifiers = parts.map(function (key) {\n            return _this.modifierKeyNameForPlatform(key);\n        });\n        return modifiers.join(\"\") + key;\n    };\n    HotkeyClass.prototype.canonicalKeyFromEvent = function (e) {\n        var key = keys[e.keyCode][e.getModifierState(\"Shift\") ? 1 : 0];\n        if (this.modifiers.indexOf(key) >= 0) {\n            return \"\";\n        }\n        var modifiers = this.modifiers.map(function (key) {\n            return e.getModifierState(key) ? key + \"+\" : \"\";\n        });\n        return modifiers.join(\"\") + this.keyName(key);\n    };\n    return HotkeyClass;\n}());\nexports.HotkeyClass = HotkeyClass;\nexports.Hotkey = new HotkeyClass();\n//# sourceMappingURL=hotkey.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar action_context_1 = require(\"../action-context/action-context\");\nfunction onClick(e) {\n    if (!(e.target instanceof HTMLElement))\n        return;\n    if (!e.target.dataset.phocusAction)\n        return;\n    action_context_1.ActionContextService.setContext(e.target);\n    action_context_1.ActionContextService.triggerAction(e.target.dataset.phocusAction);\n}\nexports.triggerableTags = [\"button\", \"a\"];\nfunction addTrigger(elt) {\n    if (!elt.dataset.phocusAction)\n        return;\n    var action = elt.dataset.phocusAction;\n    if (exports.triggerableTags.indexOf(elt.tagName.toLowerCase()) < 0) {\n        console.error(elt.tagName + \" (assigned to trigger \" + action + \") is not an accessible tag. Use a <button> or an <a>.\");\n        console.info(\"Setting role to 'button' to compensate.\");\n        elt.setAttribute(\"role\", \"button\");\n    }\n    var oldContext = action_context_1.ActionContextService.contextStack; // this store and restore thing; do it with an internal stack stack?\n    try {\n        // Add button labels, including any keyboard shortcuts\n        action_context_1.ActionContextService.setContext(elt);\n        var actionInContext = action_context_1.ActionContextService.actionForName(action);\n        if (!actionInContext) {\n            console.error(\"No action found for name \" + action, action_context_1.ActionContextService.contextStack);\n            return;\n        }\n        elt.title = actionInContext.action.label();\n        elt.setAttribute(\"aria-label\", actionInContext.action.label());\n        // Set text (if elt is empty)\n        if (elt.innerText == \"\") {\n            elt.innerText = actionInContext.action.name;\n        }\n        // Add click handler\n        elt.addEventListener(\"click\", onClick);\n    }\n    finally {\n        // Restore context previously in progress\n        action_context_1.ActionContextService.contextStack = oldContext;\n    }\n}\nexports.addTrigger = addTrigger;\nfunction removeTrigger(elt) {\n    elt.removeEventListener(\"click\", onClick);\n}\nexports.removeTrigger = removeTrigger;\n//# sourceMappingURL=add-trigger.js.map","import { Action, ActionContextService, startPhocus, ConstrainFocusService } from \"phocus\";\n\nvar maxId = 3;\n\nActionContextService.addContext(\"todo-list\", {\n  actions: {\n    add: new Action({\n      name: \"Add Todo Item\",\n      defaultKeys: [\"Control+n\"],\n      actOn: (_, elt) => {\n        // Get a new event \"from the API\"\n        const newId = ++maxId;\n        // You should use a frontend framework for this sort of thing,\n        // I'm simplifying so you can see just what Phocus is doing.\n        elt.querySelector(\"ul\").innerHTML +=\n          `<li tabindex=\"0\" data-phocus-context-name=\"todo-item\" data-phocus-context-argument=\"1\">\n             Item ${newId}\n             <div class=\"buttons\">\n               <button data-phocus-action=\"start\"></button>\n               <button data-phocus-action=\"finish\"></button>\n               <button data-phocus-action=\"delete\">&times;</button>\n             </div>\n          </li>`;\n          elt.querySelector(\"ul\").lastChild.focus();\n      }\n    })\n  }\n});\n\nActionContextService.addContext(\"todo-item\", {\n  actions: {\n    start: new Action({\n      name: \"Start\",\n      defaultKeys: [\"s\"],\n      actOn: (id, elt) => {\n        // Send a delete event to the API, or whatever you like\n        console.log(`Start item ${id}`);\n        // Update the UI\n        elt.classList.add(\"started\");\n      }\n    }),\n    finish: new Action({\n      name: \"Finish\",\n      defaultKeys: [\"f\"],\n      actOn: (id, elt) => {\n        // Send a delete event to the API, or whatever you like\n        console.log(`Finish item ${id}`);\n        // Update the UI\n        elt.classList.remove(\"started\");\n        elt.classList.add(\"finished\");\n      }\n    }),\n    delete: new Action({\n      name: \"Delete\",\n      defaultKeys: [\"Backspace\"],\n      actOn: (id, elt) => {\n        // Send a delete event to the API, or whatever you like\n        console.log(`Delete item ${id}`);\n        // Update the UI\n        elt.remove();\n      }\n    }),\n    next: new Action({\n      name: \"Next\",\n      defaultKeys: [\"ArrowDown\", \"k\"],\n      actOn: (id, elt) => {\n        elt.nextElementSibling && elt.nextElementSibling.focus();\n      }\n    }),\n    previous: new Action({\n      name: \"previous\",\n      defaultKeys: [\"ArrowUp\", \"j\"],\n      actOn: (id, elt) => {\n        elt.previousElementSibling && elt.previousElementSibling.focus();\n      }\n    })\n  }\n});\n\nwindow.addEventListener(\"load\", () => {\n  startPhocus(document.body);\n  document.querySelector(\"li\").focus();\n});\n","\"use strict\";\n// From 'The Rule of Phocus':\n// 4. Some states only allow focus among a subset of all focusable elements (modals, menus)\n//     4.1. This subset is always contained in exactly one branch of the element tree\n//\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ConstrainFocus = /** @class */ (function () {\n    function ConstrainFocus() {\n        var _this = this;\n        this.stack = [];\n        this.handler = function (e) {\n            if (_this.noConstraints())\n                return;\n            var root = _this.currentRoot();\n            if (!root)\n                return;\n            if (!e.relatedTarget)\n                return;\n            if (!root.contains(e.relatedTarget)) {\n                if (root.contains(e.target)) {\n                    e.target.focus();\n                }\n                else {\n                    root.querySelector(\"[tabindex='0']\").focus();\n                }\n            }\n        };\n    }\n    ConstrainFocus.prototype.start = function () {\n        document.addEventListener(\"blur\", this.handler, true);\n    };\n    ConstrainFocus.prototype.stop = function () {\n        document.removeEventListener(\"blur\", this.handler, true);\n    };\n    ConstrainFocus.prototype.focusable = function (element) {\n        var root = this.currentRoot();\n        return this.noConstraints() || (root && root.contains(element));\n    };\n    ConstrainFocus.prototype.currentRoot = function () {\n        return this.stack[0] && this.stack[0]();\n    };\n    ConstrainFocus.prototype.pushConstraint = function (root) {\n        this.stack.unshift(root);\n    };\n    ConstrainFocus.prototype.popConstraint = function () {\n        this.stack.shift();\n    };\n    ConstrainFocus.prototype.noConstraints = function () {\n        return this.stack.length == 0;\n    };\n    return ConstrainFocus;\n}());\nexports.ConstrainFocus = ConstrainFocus;\nexports.ConstrainFocusService = new ConstrainFocus();\n//# sourceMappingURL=constrain-focus.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar action_context_1 = require(\"../action-context/action-context\");\nvar dispatch_1 = require(\"./dispatch\");\nvar add_trigger_1 = require(\"./add-trigger\");\nvar constrain_focus_1 = require(\"../constrain-focus/constrain-focus\");\nfunction setFocusedContext() {\n    var focused = document.activeElement;\n    var focusedElement;\n    if (!(focused instanceof HTMLElement) && focused.parentElement) {\n        focusedElement = focused.parentElement;\n    }\n    else {\n        focusedElement = focused;\n    }\n    if (!focusedElement)\n        return;\n    if (focusedElement == document.body)\n        return;\n    action_context_1.ActionContextService.setContext(focusedElement);\n}\nfunction keydown(e) {\n    setFocusedContext();\n    action_context_1.ActionContextService.handleKeypress(e);\n}\nfunction observe(mutations) {\n    mutations.forEach(function (m) {\n        m.addedNodes.forEach(function (n) {\n            if (!(n instanceof HTMLElement))\n                return;\n            dispatch_1.dispatch(n);\n        });\n        if (m.type == \"attributes\" && m.target instanceof HTMLElement) {\n            if (m.target.dataset.phocusAction) {\n                add_trigger_1.addTrigger(m.target);\n            }\n            else {\n                add_trigger_1.removeTrigger(m.target);\n            }\n        }\n    });\n}\nvar observer;\nfunction startPhocus(elt) {\n    dispatch_1.dispatch(elt);\n    document.addEventListener(\"keydown\", keydown);\n    observer = new MutationObserver(observe);\n    observer.observe(elt, {\n        childList: true,\n        subtree: true,\n        attributes: true,\n        attributeFilter: [\"data-phocus-action\"]\n    });\n    constrain_focus_1.ConstrainFocusService.start();\n    console.debug(\"Phocus: Watching for changes.\");\n}\nexports.startPhocus = startPhocus;\nfunction stopPhocus(elt) {\n    dispatch_1.undispatch(elt);\n    document.removeEventListener(\"keydown\", keydown);\n    observer.disconnect();\n    constrain_focus_1.ConstrainFocusService.stop();\n    console.debug(\"Phocus: Watching stopped.\");\n}\nexports.stopPhocus = stopPhocus;\n//# sourceMappingURL=start-phocus.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar add_trigger_1 = require(\"./add-trigger\");\nfunction dispatch(elt) {\n    if (elt.dataset.phocusAction) {\n        add_trigger_1.addTrigger(elt);\n    }\n    var children = elt.querySelectorAll(\"[data-phocus-action]:not([data-phocus-acion=''])\");\n    Array.from(children).forEach(function (e) {\n        if (!(e instanceof HTMLElement))\n            return;\n        add_trigger_1.addTrigger(e);\n    });\n}\nexports.dispatch = dispatch;\nfunction undispatch(elt) {\n    if (elt.dataset.phocusAction) {\n        add_trigger_1.removeTrigger(elt);\n    }\n    var children = elt.querySelectorAll(\"[data-phocus-action]:not([data-phocus-acion=''])\");\n    Array.from(children).forEach(function (e) {\n        if (!(e instanceof HTMLElement))\n            return;\n        add_trigger_1.removeTrigger(e);\n    });\n}\nexports.undispatch = undispatch;\n//# sourceMappingURL=dispatch.js.map"],"sourceRoot":""}